---
title: "AS2-3: ç¾åœ‹äººå£æ™®æŸ¥è³‡æ–™"
author: "Group-00"
date: "`r Sys.time()`"
output: 
  html_document:
    highlight: pygments
    theme: flatly
    css: ../etc/style.css
---

```{r echo=F, results='hide', message=FALSE, warning=FALSE}
# Installation, setup & formatting. Do not modify this code chunk.  
rm(list=ls(all=T))
knitr::opts_chunk$set(comment = NA)
knitr::opts_knit$set(global.par = TRUE)
par(cex=0.8); options(scipen=20, digits=4, width=90)
if(!require(pacman)) install.packages("pacman")
pacman::p_load(dplyr)
```
<br><br>

The major data is in `data/MetroAreaCodes.csv`. We read it into a data frame `D`.
```{r}
D = read.csv("data/CPSData.csv")
```

`D` ä¹‹ä¸­æ¯ä¸€ç­†ç´€éŒ„æ˜¯ä¸€å€‹å—æ¸¬å°è±¡ï¼Œæ¯ä¸€å€‹æ¬„ä½æ˜¯ä¸€å€‹èª¿æŸ¥å•å·é¡Œé …ï¼š

+ `PeopleInHousehold`: å—è¨ªè€…å®¶åº­ä¸­çš„äººæ•¸ã€‚
+ `Region`: å—è¨ªè€…å±…ä½çš„äººå£æ™®æŸ¥å€åŸŸã€‚
+ `State`: å—è¨ªè€…å±…ä½çš„å·ã€‚
+ `MetroAreaCode`: éƒ½æœƒå€ä»£ç¢¼ï¼Œå¦‚å—è¨ªè€…ä¸ä½éƒ½æœƒå€ï¼Œå‰‡ç‚ºNAï¼›å¾ä»£ç¢¼åˆ°éƒ½æœƒå€åç¨±çš„å°æ‡‰åœ¨`MetroAreaCodes.csv`ä¸­æä¾›ã€‚
+ `Age`: å—è¨ªè€…çš„å¹´é½¡ï¼Œä»¥å¹´ç‚ºå–®ä½ã€‚ 80ä»£è¡¨80-84æ­²çš„äººï¼Œ85ä»£è¡¨85æ­²åŠä»¥ä¸Šçš„äººã€‚
+ `Married`: å—è¨ªè€…çš„å©šå§»ç‹€æ³ã€‚
+ `Sex`: å—è¨ªè€…çš„æ€§åˆ¥ã€‚
+ `Education`: å—è¨ªè€…ç²å¾—çš„æœ€é«˜æ•™è‚²ç¨‹åº¦ã€‚
+ `Race`: å—è¨ªè€…çš„ç¨®æ—ã€‚
+ `Hispanic`: å—è¨ªè€…æ˜¯å¦å±¬æ–¼è¥¿ç­ç‰™è£”ã€‚
+ `CountryOfBirthcode`: è­˜åˆ¥å—è¨ªè€…å‡ºç”Ÿåœ‹å®¶çš„ä»£ç¢¼ã€‚å¾ä»£ç¢¼åˆ°åœ‹å®¶åç¨±çš„æ˜ å°„åœ¨CountryCodes.csvæ–‡ä»¶ä¸­æä¾›ã€‚
+ `Citizenship`: å—è¨ªè€…çš„å…¬æ°‘èº«ä»½ã€‚
+ `EmploymentStatus`: å—è¨ªè€…çš„å°±æ¥­ç‹€æ³ã€‚
+ `Industry`: å—è¨ªè€…çš„å°±æ¥­è¡Œæ¥­ï¼ˆåƒ…åœ¨å—åƒ±çš„æƒ…æ³ä¸‹å¯ç”¨ï¼‰ã€‚

<br>

ğŸŒ· é€™ä»½ä½œæ¥­çš„å­¸ç¿’é‡é»æ˜¯ï¼š 

+ ç¼ºé … (`NA`) çš„è§€å¿µå’Œè™•ç†æ–¹æ³•
+ è³‡æ–™è¡¨æ ¼(data frame)çš„åˆä½µ

<br>

```{r}
summary(D)
```
In the `summary` we can see that there are 34,238 `NA`'s in `MetroAreaCode`.  Yet be careful ...

ğŸŒ· `summary` does not shows the numbers of `NA` in the character columns.

The best way to examine `NA` in a data frame is to pipe `is.na()` into `colSums()`.
```{r}
is.na(D) %>% colSums
```
now we see there are `NA`'s in `Married`, `Education`, `EmploymentStatus` and `Industry`. In the case of census, `NA` may occur when question items are ...

+ not answered
+ answered improperly 
+ not applicable to the respondents

<br><br>

###  Section-1 Loading and Summarizing the Dataset

__Â§ 1.1__ How many interviewees are in the dataset?
```{r}
#
#
```

__Â§ 1.2__ Among the interviewees with a value reported for the Industry variable, what is the most common industry of employment? Please enter the name exactly how you see it.
```{r}
#
#
```

__Â§ 1.3__ Which state has the fewest interviewees?
```{r}
#
#
```

Which state has the largest number of interviewees?
```{r}
#
#
```

__Â§ 1.4__ What proportion of interviewees are citizens of the United States?
```{r}
#
#
```

__Â§ 1.5__ For which races are there at least 250 interviewees in the CPS dataset of Hispanic ethnicity? 
```{r}
#
#
```

<br><br> 


###  Section-2 Evaluating Missing Values

__Â§ 2.1__ Which variables have at least one interviewee with a missing (NA) value? 
```{r}
#
#
```

__Â§ 2.2__  Which statements below is the most accurate:

+ The Married variable being missing is related to the Region value for the interviewee.
+ The Married variable being missing is related to the Sex value for the interviewee.
+ The Married variable being missing is related to the Age value for the interviewee. 
+ The Married variable being missing is related to the Citizenship value for the interviewee.
+ The Married variable being missing is not related to the Region, Sex, Age, or Citizenship value for the interviewee.

```{r}
#
#
```

ğŸŒ» Married is not applicable for interviewees who is younger than 15 years old. This type of `NA` occurs systematically. They are not random.  

__Â§ 2.3__ How many states had all interviewees living in a non-metropolitan area (aka they have a missing `MetroAreaCode` value)? For this question, treat the District of Columbia as a state (even though it is not technically a state).
```{r}
#
#
```

How many states had all interviewees living in a metropolitan area? Again, treat the District of Columbia as a state.
```{r}
#
#
```

__Â§ 2.4__ Which region of the United States has the largest proportion of interviewees living in a non-metropolitan area?
```{r}
#
#
```

__Â§ 2.5__ Which state has a proportion of interviewees living in a non-metropolitan area closest to 30%?
```{r}
#
#
```

Which state has the largest proportion of non-metropolitan interviewees, ignoring states where all interviewees were non-metropolitan?
```{r}
#
#
```

ğŸŒ» As we can see in the questions above, `NA`'s are not completely useless. Sometimes they carry useful information. 

<br><br> 

###  Section-3 Integrating Metropolitan Area Data

In this exercise, we have two more data files 

+ `data/MetroAreaCodes.csv` maps `D$MetroAreaCode` to the names of the Metro Area's
+ `data/CountryCodes.csv` maps `D$CountryCode` to the names of the Countries

```{r}
metro = read.csv("data/MetroAreaCodes.csv")
country = read.csv("data/CountryCodes.csv")
```

__Â§ 3.1__ How many observations (codes for metropolitan areas) are there in `MetroAreaMap`?
```{r}
# 
#
```

How many observations (codes for countries) are there in CountryMap?
```{r}
#
#
```

ğŸŒ» `merge(x, y, by.x, by.y, all.x, all.y)` merges two data frames `x` and `y`

+ `by.x` and `by.y` specify the merging keys in `x` and `y` respectively.
+ `all.x` and `all.y` specify whether all rows in `x` and `y` should be kept. The defaults are `FALSE` which implies rows that do not match are removed. When set to `TRUE`, the unmatched rows stay with the merged columns set to `NA`.

__Â§ 3.2__ Merge the `MetroArea` variable into the `D` data frame by merging keys `MetroAreaCode` and `Code`. What is the name of the variable that was added to the data frame by the merge() operation?
```{r}
D = merge(D, metro, by.x="MetroAreaCode", by.y="Code", all.x=TRUE)
```

How many interviewees have a missing value for the new metropolitan area variable?
```{r}
#
#
```

__Â§ 3.3__ Which of the following metropolitan areas has the largest number of interviewees?
```{r}
#
#
```

__Â§ 3.4__ Which metropolitan area has the highest proportion of interviewees of Hispanic ethnicity?
```{r}
#
#
```

__Â§ 3.5__ Determine the number of metropolitan areas in the United States from which at least 20% of interviewees are Asian.
```{r}
#
#
```

ğŸŒ» All mathematical and logical function return `NA` if there is any `NA` in their input vector(s). As an remedy, the `na.rm=TRUE` argument can exclude the `NA`'s from the input before calculation.    

__Â§ 3.6__  Passing `na.rm=TRUE` to the `tapply` function, determine which metropolitan area has the smallest proportion of interviewees who have received no high school diploma.
```{r}
#
#
```

<br><br> 


###  Section-4 Integrating Country of Birth Data

__Â§ 4.1__ Merge the `Country` variable into the `D` data frame by merging keys `CountryOfBirthCode` and `Code`. What is the name of the variable added to the data frame by this merge operation?
```{r}
D = merge(D, country, by.x="CountryOfBirthCode", by.y="Code", all.x=TRUE)
```

How many interviewees have a missing value for the new country variable?
```{r}
#
#
```

__Â§ 4.2__ Among all interviewees born outside of North America, which country was the most common place of birth?
```{r}
#
#
```

__Â§ 4.3__ What proportion of the interviewees from the "New York-Northern New Jersey-Long Island, NY-NJ-PA" metropolitan area have a country of birth that is not the United States? 
```{r}
#
#
```

__Â§ 4.4__ Which metropolitan area has the largest number (note -- not proportion) of interviewees with a country of birth in India? 
```{r}
#
#
```

In Brazil?
```{r}
#
#
```

In Somalia?
```{r}
#
#
```

<br><br><br>
