ylab("平均購買次數") +
xlab("平均客單價")
combined_data <- A0 %>%
filter(age != "a99" & !is.na(area)) %>%
group_by(age, area) %>%
summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
)
# 建立泡泡圖
ggplot(combined_data, aes(y = avg.Freq, x = avg.Revenue, size = Group.Size, color = paste(age, area))) +
geom_point(alpha = 0.5) +
geom_text(aes(label = paste(age, area)), vjust = -0.5) +
scale_size(range = c(5, 25)) +
theme_bw() +
ggtitle("年齡與地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") +
xlab("平均客單價")
combined_data <- A0 %>%
filter(age == "a34" & !is.na(area)) %>%
group_by(age, area) %>%
summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
)
# 建立泡泡圖
ggplot(combined_data, aes(y = avg.Freq, x = avg.Revenue, size = Group.Size, color = paste(age, area))) +
geom_point(alpha = 0.5) +
geom_text(aes(label = paste(age, area)), vjust = -0.5) +
scale_size(range = c(5, 25)) +
theme_bw() +
ggtitle("年齡與地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") +
xlab("平均客單價")
top20 = tapply(Z0$qty,Z0$cat,sum) %>% sort %>% tail(20) %>% names
top20 = tapply(Z0$qty,Z0$cat,sum) %>% sort %>% tail(20) %>% names
MOSA(~age+cat, Z0[Z0$cat %in% top20,])
top20_a34<-subset(top20,age=a34)
top20_a34<-subset(top20,age="a34")
View(Z0)
top20_a34<-subset(top20,age=="a34")
View(A0)
View(A0)
View(A0)
View(Z0)
View(Z0)
View(A0)
View(A0)
# 僅專注於年齡為 "a34" 的顧客
age_of_interest <- "a34"
subset_Z0_a34 <- subset(Z0, age == age_of_interest)
# 取出 top20 產品類別
top20_categories <- tapply(Z0$qty, Z0$cat, sum) %>%
sort() %>%
tail(20) %>%
names()
# 僅保留特定年齡顧客購買 top20 產品類別的消費情況
subset_Z0_top20_a34 <- subset(subset_Z0_a34, cat %in% top20_categories)
# 執行 MOSA 分析
MOSA(~age+cat, subset_Z0_top20_a34)
# 僅專注於年齡為 "a34" 的顧客
age_of_interest <- "a34"
subset_Z0_a34 <- subset(Z0, age == age_of_interest)
# 取出 top20 產品類別
top20_categories <- tapply(Z0$qty, Z0$cat, sum) %>%
sort() %>%
tail(200) %>%
names()
# 僅保留特定年齡顧客購買 top20 產品類別的消費情況
subset_Z0_top20_a34 <- subset(subset_Z0_a34, cat %in% top20_categories)
# 執行 MOSA 分析
MOSA(~age+cat, subset_Z0_top20_a34)
ggplot(combined_data, aes(x = avg.Revenue, y = avg.Freq, fill = Group.Size)) +
geom_tile() +
scale_fill_gradient(low = "lightblue", high = "darkblue") +
geom_text(aes(label = paste(age, area)), vjust = -0.5) +
theme_bw() +
ggtitle("年齡與地理區隔特徵 (熱圖:族群人數)") +
ylab("平均購買次數") +
xlab("平均客單價")
knitr::opts_chunk$set(echo = TRUE)
#1. 資料前處理
pacman::p_load(magrittr, readr, caTools, ggplot2, dplyr, vcd)
load("data/tf0.rdata")
sapply(list(cust=A0,tid=X0,items=Z0), nrow)
A0 %>% group_by(age) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=age, size=Group.Size), alpha=0.5) +
geom_text(aes(label=age)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("年齡區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(age) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=age, size=Group.Size), alpha=0.5) +
geom_text(aes(label=age)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("年齡區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
combined_data <- A0 %>%
filter(age == "a34" & !is.na(area)) %>%
group_by(age, area) %>%
summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
)
# 建立泡泡圖
ggplot(combined_data, aes(y = avg.Freq, x = avg.Revenue, size = Group.Size, color = paste(age, area))) +
geom_point(alpha = 0.5) +
geom_text(aes(label = paste(age, area)), vjust = -0.5) +
scale_size(range = c(5, 25)) +
theme_bw() +
ggtitle("年齡與地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") +
xlab("平均客單價")
ggplot(combined_data, aes(x = avg.Revenue, y = avg.Freq, fill = Group.Size)) +
geom_tile() +
scale_fill_gradient(low = "lightblue", high = "darkblue") +
geom_text(aes(label = paste(age, area)), vjust = -0.5) +
theme_bw() +
ggtitle("年齡與地理區隔特徵 (熱圖:族群人數)") +
ylab("平均購買次數") +
xlab("平均客單價")
top20 = tapply(Z0$qty,Z0$cat,sum) %>% sort %>% tail(20) %>% names
MOSA(~age+cat, Z0[Z0$cat %in% top20,])
table(A0$age,A0$area) %>%
as.data.frame.matrix %>%
d3heatmap(col=colorRamp(c('seagreen','lightyellow','red')),Rowv = NA,Colv = NA)
table(A0$age,A0$area) %>%
as.data.frame.matrix %>%
heatmap(col=colorRamp(c('seagreen','lightyellow','red')),Rowv = NA,Colv = NA)
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
MOSA(~cat+area, Z0[Z0$cat %in% top20,])
MOSA(~cat+area, Z0[Z0$cat %in% top20,])
top20 = tapply(Z0$qty,Z0$cat,sum) %>% sort %>% tail(20) %>% names
MOSA(~age+cat, Z0[Z0$cat %in% top20,])
knitr::opts_chunk$set(echo = TRUE)
#1. 資料前處理
pacman::p_load(magrittr, readr, caTools, ggplot2, dplyr, vcd)
load("data/tf0.rdata")
sapply(list(cust=A0,tid=X0,items=Z0), nrow)
pacman::p_load(vcd, magrittr, readr, caTools, ggplot2, dplyr, plotly)
A0 %>% group_by(age) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=age, size=Group.Size), alpha=0.5) +
geom_text(aes(label=age)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("年齡區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(age) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=age, size=Group.Size), alpha=0.5) +
geom_text(aes(label=age)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("年齡區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
combined_data <- A0 %>%
filter(age == "a34" & !is.na(area)) %>%
group_by(age, area) %>%
summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
)
# 建立泡泡圖
ggplot(combined_data, aes(y = avg.Freq, x = avg.Revenue, size = Group.Size, color = paste(age, area))) +
geom_point(alpha = 0.5) +
geom_text(aes(label = paste(age, area)), vjust = -0.5) +
scale_size(range = c(5, 25)) +
theme_bw() +
ggtitle("年齡與地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") +
xlab("平均客單價")
ggplot(combined_data, aes(x = avg.Revenue, y = avg.Freq, fill = Group.Size)) +
geom_tile() +
scale_fill_gradient(low = "lightblue", high = "darkblue") +
geom_text(aes(label = paste(age, area)), vjust = -0.5) +
theme_bw() +
ggtitle("年齡與地理區隔特徵 (熱圖:族群人數)") +
ylab("平均購買次數") +
xlab("平均客單價")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
top20 = tapply(Z0$qty,Z0$cat,sum) %>% sort %>% tail(20) %>% names
MOSA(~age+cat, Z0[Z0$cat %in% top20,])
MOSA(~cat+area, Z0[Z0$cat %in% top20,])
MOSA = function(formula, data) mosaic(formula, data, shade=T,
margins=c(0,1,0,0), labeling_args = list(rot_labels=c(90,0,0,0)),
gp_labels=gpar(fontsize=9), legend_args=list(fontsize=9),
gp_text=gpar(fontsize=7),labeling=labeling_residuals)
top20 = tapply(Z0$qty,Z0$cat,sum) %>% sort %>% tail(20) %>% names
MOSA(~age+cat, Z0[Z0$cat %in% top20,])
MOSA(~cat+area, Z0[Z0$cat %in% top20,])
knitr::opts_chunk$set(echo = TRUE)
Z = read.csv("data/ta_feng_all_months_merged.csv") %>% data.frame %>% setNames(c("date","cust","age","area","cat","prod","qty","cost","price"))
if(!require(pacman)) install.packages("pacman")
pacman::p_load(magrittr, readr, caTools, ggplot2, dplyr, vcd,plotly)
library(magrittr)
library(vcd)
library(corrplot)
Z = read.csv("data/ta_feng_all_months_merged.csv") %>% data.frame %>% setNames(c("date","cust","age","area","cat","prod","qty","cost","price"))
#date=交易日,cust=顧客ID,age=顧客年齡
#area=郵遞區號105松山 106大安 110信義 114內湖 115南港 221汐止
#cat=產品品類, prod=產品ID, qty=當筆購買數量,cost=成本,price=售價
Z$date = as.Date(Z$date, format="%m/%d/%Y")
#日期格式轉換
age.group = c("<25","25-29","30-34","35-39","40-44",
"45-49","50-54","55-59","60-64",">65")
Z$age = c(paste0("a",seq(24,69,5)),"a99")[match(Z$age,age.group,11)]
Z$area = paste0("z",Z$area)
#依年齡分組，間隔為5歲
#再將分組設代號，a99為找不到年齡區間配對者
#將地區設代號
nrow(Z)
450000/817741
550000/817741
#資料區間:2000/11/1-2001/2/28 (共計4個月)
#共計817741筆資料
#a34-a44為主要消費力客群
#a49-53總商品購買數量>a29以下客群(但獲利率待確認)
#115南港&221汐止區為主要的消費地區
#105松山,106大安,114內湖區三處消費力低
#內湖的工商辦公大樓居多
library(magrittr)
library(vcd)
Z = read.csv("data/ta_feng_all_months_merged.csv") %>% data.frame %>% setNames(c("date","cust","age","area","cat","prod","qty","cost","price"))
#date=交易日,cust=顧客ID,age=顧客年齡
#area=郵遞區號105松山 106大安 110信義 114內湖 115南港 221汐止
#cat=產品品類, prod=產品ID, qty=當筆購買數量,cost=成本,price=售價
knitr::opts_chunk$set(echo = TRUE)
#1. 資料前處理
pacman::p_load(magrittr, readr, caTools, ggplot2, dplyr, vcd)
load("data/tf0.rdata")
sapply(list(cust=A0,tid=X0,items=Z0), nrow)
pacman::p_load(vcd, magrittr, readr, caTools, ggplot2, dplyr, plotly)
A0 %>% group_by(age) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=age, size=Group.Size), alpha=0.5) +
geom_text(aes(label=age)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("年齡區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(age) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=age, size=Group.Size), alpha=0.5) +
geom_text(aes(label=age)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("年齡區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
combined_data <- A0 %>%
filter(age == "a34" & !is.na(area)) %>%
group_by(age, area) %>%
summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
)
# 建立泡泡圖
ggplot(combined_data, aes(y = avg.Freq, x = avg.Revenue, size = Group.Size, color = paste(age, area))) +
geom_point(alpha = 0.5) +
geom_text(aes(label = paste(age, area)), vjust = -0.5) +
scale_size(range = c(5, 25)) +
theme_bw() +
ggtitle("年齡與地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") +
xlab("平均客單價")
ggplot(combined_data, aes(x = avg.Revenue, y = avg.Freq, fill = Group.Size)) +
geom_tile() +
scale_fill_gradient(low = "lightblue", high = "darkblue") +
geom_text(aes(label = paste(age, area)), vjust = -0.5) +
theme_bw() +
ggtitle("年齡與地理區隔特徵 (熱圖:族群人數)") +
ylab("平均購買次數") +
xlab("平均客單價")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
MOSA = function(formula, data) mosaic(formula, data, shade=T,
margins=c(0,1,0,0), labeling_args = list(rot_labels=c(90,0,0,0)),
gp_labels=gpar(fontsize=9), legend_args=list(fontsize=9),
gp_text=gpar(fontsize=7),labeling=labeling_residuals)
top20 = tapply(Z0$qty,Z0$cat,sum) %>% sort %>% tail(20) %>% names
MOSA(~age+cat, Z0[Z0$cat %in% top20,])
MOSA(~cat+area, Z0[Z0$cat %in% top20,])
library(magrittr)
library(vcd)
Z = read.csv("data/ta_feng_all_months_merged.csv") %>% data.frame %>% setNames(c("date","cust","age","area","cat","prod","qty","cost","price"))
#date=交易日,cust=顧客ID,age=顧客年齡
#area=郵遞區號105松山 106大安 110信義 114內湖 115南港 221汐止
#cat=產品品類, prod=產品ID, qty=當筆購買數量,cost=成本,price=售價
Z$date = as.Date(Z$date, format="%m/%d/%Y")
#日期格式轉換
age.group = c("<25","25-29","30-34","35-39","40-44",
"45-49","50-54","55-59","60-64",">65")
Z$age = c(paste0("a",seq(24,69,5)),"a99")[match(Z$age,age.group,11)]
Z$area = paste0("z",Z$area)
#依年齡分組，間隔為5歲
#再將分組設代號，a99為找不到年齡區間配對者
#將地區設代號
nrow(Z)
450000/817741
550000/817741
#資料區間:2000/11/1-2001/2/28 (共計4個月)
#共計817741筆資料
#a34-a44為主要消費力客群
#a49-53總商品購買數量>a29以下客群(但獲利率待確認)
#115南港&221汐止區為主要的消費地區
#105松山,106大安,114內湖區三處消費力低
#內湖的工商辦公大樓居多
par(mfrow=c(1,2),cex=0.5)
table(Z$age, useNA='ifany') %>% barplot(main="Age Groups", las=1,col="lightpink")
table(Z$area,useNA='ifany') %>% barplot(main="Areas", las=2,col="lightblue")
#mfrow=c(1,2) one row two column
sapply(Z[,7:9], quantile, prob=c(.99, .999, .9995,1))
#排除離群值，只鎖定99.95%的數據
Z = subset(Z, qty<=24 & cost<=3800 & price<=4000)
nrow(Z)
#總筆數817741減少559筆，變為817182筆
Z$tid = group_indices(Z, date, cust)
#將同一天、同一顧客的交易項目彙總為一張訂單
sapply(Z[c("cust","cat","prod","tid")], n_distinct)
#資料總覽
#sapply()對資料框中每列進行同一function
#n_distince計算唯一值數量
#合併後共計119422筆訂單,產品品類為2007項,不同顧客為32256名
X = Z %>% group_by(tid) %>% summarise(
date = min(date),          # 交易日期
cust = min(cust),          # 顧客 ID
age = min(age),            # 顧客 年齡級別
area = min(area),          # 顧客 居住區別
items = n(),               # 交易項目(總)數
pieces = sum(qty),         # 產品(總)件數
total = sum(price),        # 交易(總)金額
gross = sum(price - cost)  # 毛利
) %>% data.frame
nrow(X) # 119422
sapply(X[,6:9], quantile, prob=c(.999, .9995, .9999,1))
X = subset(X, items<=62 & pieces<95 & total<16000) # 119328
#移除離群值，只保留99.99%數據
#訂單筆數由119422減少為119328筆
summary(X)
d0 = max(X$date) + 1
A = X %>% mutate(
days = as.integer(difftime(d0, date, units="days"))
) %>% group_by(cust) %>% summarise(
r = min(days),      # recency最小天數差異
s = max(days),      # seniority最大天數差異
f = n(),            # frequency頻率
m = mean(total),    # monetary金額的平均值
rev = sum(total),   # total revenue contribution總收入貢獻
raw = sum(gross),   # total gross profit contribution總毛利貢獻
age = min(age),     # age group
area = min(area),   # area code
) %>% data.frame
nrow(A) # 32241
summary(A)
A0 = A; X0 = X; Z0 = Z
save(Z0, X0, A0, file="C:/Users/abcmm/R practice/CM512-6/data/ta_feng_all_months_merged.csv")
# 這些程式碼設定網頁的格式，並安裝、載入一些基本的套件，請大家不要去改動<br>
rm(list=ls(all=T))
knitr::opts_chunk$set(comment = NA)
knitr::opts_knit$set(global.par = TRUE)
par(cex=0.8)
options(scipen=20, digits=5, width=80)
if(!require(FactoMineR)) install.packages("FactoMineR")
if(!require(factoextra)) install.packages("factoextra")
if(!require(MASS)) install.packages("MASS")
if(!require(dendextend)) install.packages("dendextend")
if(!require(pacman)) install.packages("pacman")
pacman::p_load(dplyr, ggplot2, readr, FactoMineR, factoextra, dendextend)
W = read.csv('data/wholesales.csv')
W$Channel = factor( paste0("Ch",W$Channel) )
W$Region = factor( paste0("Reg",W$Region) )
W[3:8] = lapply(W[3:8], log, base=10)
summary(W)
hc = W[,3:4] %>% scale %>% dist %>% hclust
plot(hc)
k=6; rect.hclust(hc, k=k, border="red")
W$group = cutree(hc, k=8) %>% factor
ggplot(W, aes(x=Fresh, y=Milk, col=group)) +
geom_point(size=3, alpha=0.5)
hc = W[,3:7] %>% scale %>% dist %>% hclust
plot(hc)
k = 6; rect.hclust(hc, k, border="red")
W$group = cutree(hc, k) %>% factor
hc %>% as.dendrogram %>% color_branches(k) %>% color_labels(k,col='white') %>% plot
names(W)[3:8] = c('生鮮','奶製品','雜貨','冷凍','清潔用品','熟食')
W[,3:8] %>% PCA(graph=FALSE) %>% fviz_pca_biplot(
col.ind=W$group,  #
label="var", pointshape=19, mean.point=F,
addEllipses=T, ellipse.level=0.7,
ellipse.type = "convex", palette="ucscgb",
repel=T
)
# This Chunk is for format setting, Do NOT Change the codes!
rm(list=ls(all=T))
knitr::opts_chunk$set(comment = NA)
knitr::opts_knit$set(global.par = TRUE)
par(cex=0.8)
options(scipen=20, digits=5, width=80)
if(!require(pacman)) install.packages("pacman")
pacman::p_load(dplyr, FactoMineR, factoextra)
D = decathlon2
head(D)
pca = PCA(D[,1:10])
pca
get_eigenvalue(pca)
pca$var$coord
pca$var$cos2
fviz_pca_var(pca)
pca$ind$coord
pca$ind$cos2
fviz_pca_ind(pca)
fviz_pca_biplot(
pca, pointsize="cos2", repel=T, labelsize=3,
col.var="red", col.ind="#E7B800", alpha.ind=0.3)
set.seed(444)
kmg = kmeans(scale(D[,1:10]), 5)$cluster %>% factor
table(kmg)
fviz_pca_biplot(
pca, repel=T, col.var="black", labelsize=3,
col.ind=kmg, alpha.ind=0.6, pointshape=16,
addEllipses = T, ellipse.level = 0.65,
mean.point = FALSE) +
theme(legend.position = "none")
fviz_pca_biplot(
pca, axes=c(1,3),
repel=T, col.var="black", labelsize=3,
col.ind=kmg, alpha.ind=0.6, pointshape=16,
addEllipses = T, ellipse.level = 0.65,
mean.point = FALSE) +
theme(legend.position = "none")
View(D)
load("C:/GitHub/NSYSU_CM512/code/mid/tafen123/data/tf0.rdata")
View(Z0)
View(X0)
View(X0)
load("C:/GitHub/NSYSU_CM512/code/mid/tafen123/data/tf3.rdata")
View(Z0)
View(Z0)
View(Z)
View(Z)
View(A0)
