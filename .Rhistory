lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("1997-09-01","1997-11-01")),col='gray',lty=3)
#
#
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange',xlim=as.Date(c('1997-09-01','1997-11-01')),ylim=c(0,250))
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("1997-09-01","1997-11-01")),col='gray',lty=3)
#
#
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange',xlim=as.Date(c('1997-01-01','1998-01-01')),ylim=c(0,250))
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("1997-09-01","1997-11-01")),col='gray',lty=3)
#
#
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange',xlim=as.Date(c('1996-01-01','1999-01-01')),ylim=c(0,250))
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("1997-09-01","1997-11-01")),col='gray',lty=3)
#
# PnG &
#
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange',xlim=as.Date(c('2004-01-01','2005-12-31')),ylim=c(0,250))
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("1997-09-01","1997-11-01")),col='gray',lty=3)
#
#
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange',xlim=as.Date(c('2000-01-01','2005-12-31')),ylim=c(0,250))
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("1997-09-01","1997-11-01")),col='gray',lty=3)
#
#
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange',xlim=as.Date(c('1990-01-01','2005-12-31')),ylim=c(0,250))
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("1997-09-01","1997-11-01")),col='gray',lty=3)
#
#
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange',)
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("2004-01-01")),col='gray',lty=3)
#
# PnG & Boeing
#
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange')
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("2004-01-01","2005-12-31")),col='gray',lty=3)
#
#
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange',xlim=as.Date(c('1996-01-01','1999-01-01')),ylim=c(0,250))
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("1997-09-01","1997-11-01")),col='gray',lty=3)
#
# PnG & Boeing
#
tapply(L$IBM$StockPrice,format(L$IBM$Date,'%m'), mean)
#
#
tapply(L$IBM,format(L$IBM$Date,'%m') ,function(df){
mean(df$StockPrice)
})
#
tapply(L$IBM,format(L$IBM$Date,'%m') ,mean)
#
tapply(L$IBM$StockPrice,format(L$IBM$Date,'%m') ,mean)
#
#
mx = sapply(L, function(df) {
tapply(df$StockPrice, format(df$Date, "%m"), mean) })
#
#
mon_ave = sapply(L, function(df) {
tapply(df$StockPrice, format(df$Date, "%m"), mean) })
mon_ave
#
#
mon_ave = sapply(L, function(df) {
tapply(df$StockPrice, format(df$Date, "%m"), mean) %>%sort})
# Installation, setup & formatting. Do not modify this code chunk.
rm(list=ls(all=T))
knitr::opts_chunk$set(comment = NA)
knitr::opts_knit$set(global.par = TRUE)
par(cex=0.8); options(scipen=20, digits=4, width=90)
if(!require(pacman)) install.packages("pacman")
if(!require(dplyr)) install.packages("dplyr")
pacman::p_load(dplyr)
#
mon_ave = sapply(L, function(df) {
tapply(df$StockPrice, format(df$Date, "%m"), mean) %>%sort})
L = list(
IBM = read.csv("data/IBMStock.csv"),
GE = read.csv("data/GEStock.csv"),
PnG = read.csv("data/ProcterGambleStock.csv"),
Coke = read.csv("data/CocaColaStock.csv"),
Boeing = read.csv("data/BoeingStock.csv"))
#
mon_ave = sapply(L, function(df) {
tapply(df$StockPrice, format(df$Date, "%m"), mean) %>%sort})
#
mon_ave = sapply(L, function(df) {
tapply(df$StockPrice, format(df$Date,'%m'), mean) %>%sort})
#
mon_ave = sapply(L, function(df) {
tapply(df$StockPrice, format(df$Date,'%m'), mean) })
mx = sapply(L, function(df) {
tapply(df$StockPrice, format(df$Date, "%m"), mean) })
# Installation, setup & formatting. Do not modify this code chunk.
rm(list=ls(all=T))
knitr::opts_chunk$set(comment = NA)
knitr::opts_knit$set(global.par = TRUE)
par(cex=0.8); options(scipen=20, digits=4, width=90)
if(!require(pacman)) install.packages("pacman")
if(!require(dplyr)) install.packages("dplyr")
pacman::p_load(dplyr)
L = list(
IBM = read.csv("data/IBMStock.csv"),
GE = read.csv("data/GEStock.csv"),
PnG = read.csv("data/ProcterGambleStock.csv"),
Coke = read.csv("data/CocaColaStock.csv"),
Boeing = read.csv("data/BoeingStock.csv"))
lapply(L, class)
sapply(L, class)
sapply(L, names)
L = lapply(L, function(df) {
df$Date =  as.Date(df$Date, format="%m/%d/%y")
df
} )
#
sapply(L, count)
#
#
f<-function(df){
min(df$Date)
}
lapply(L,f)
#
#
f<-function(df){
max(df$Date)
}
lapply(L,f)
#
#
mean(L$IBM$StockPrice)
#
#
min(L$GE$StockPrice)
#
#
max(L$Coke$StockPrice)
#
#
median(L$Boeing$StockPrice)
#
#
sd(L$PnG$StockPrice)
#
#
plot(L$Coke$Date,L$Coke$StockPrice,type ='l')
#
#
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange')
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("2000-03-01","1983-01-01","1984-01-01")),col='gray',lty=3)
#
#
#Coca-Cola
#
#
#Boeing
f<-function(df){
mean(df$StockPrice)
}
lapply(L,f)
#
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange',xlim=as.Date(c('1995-01-01','2005-12-01')),ylim=c(0,250))
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("2000-03-01","2000-05-01")),col='gray',lty=3)
#
# GE
#
#
# IBM
#
#
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange',xlim=as.Date(c('1996-01-01','1999-01-01')),ylim=c(0,250))
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("1997-09-01","1997-11-01")),col='gray',lty=3)
#
# PnG & Boeing
#
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange')
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("2004-01-01","2005-12-31")),col='gray',lty=3)
#
# Boeing
#
tapply(L$IBM$StockPrice,format(L$IBM$Date,'%m'), mean)
#
#
mon_ave = sapply(L, function(df) {
tapply(df$StockPrice, format(df$Date,'%m'), mean) %>%sort})
mon_ave
#
#
#
mx = sapply(L, function(df) {
tapply(df$StockPrice, format(df$Date, "%m"), mean) })
mx
apply(mx, 2, which.max)
mx[c(1,12),]
#
mon_ave = sapply(L, function(df) {
tapply(df$StockPrice, format(df$Date,'%m'), mean)})
mon_ave
#
#
mon_ave = sapply(L, function(df) {
tapply(df$StockPrice, format(df$Date,'%m'), mean)%>%max})
mon_ave
#
#
mon_ave = sapply(L, function(df) {
tapply(df$StockPrice, format(df$Date,'%m'), mean)})
mon_ave
#
#
mon_ave = sapply(L, function(df) {
tapply(df$StockPrice, format(df$Date,'%m'), mean)})
mon_ave
#
#
mon_ave = sapply(L, function(df) {
tapply(df$StockPrice, format(df$Date,'%m'), mean)})
mon_ave
#
# December
#
tapply(L$GE$StockPrice,format(L$GE$Date,'%m'), mean)
tapply(L$Coke$StockPrice,format(L$Coke$Date,'%m'), mean)
#
#
sort(tapply(L$GE$StockPrice,format(L$GE$Date,'%m'), mean),decreasing = T)
tapply(L$Coke$StockPrice,format(L$Coke$Date,'%m'), mean)
#
#
sort(tapply(L$GE$StockPrice,format(L$GE$Date,'%m'), mean),decreasing = T)
sort(tapply(L$Coke$StockPrice,format(L$Coke$Date,'%m'), mean),,decreasing = T)
#
# Installation, setup & formatting. Do not modify this code chunk.
rm(list=ls(all=T))
knitr::opts_chunk$set(comment = NA)
knitr::opts_knit$set(global.par = TRUE)
par(cex=0.8); options(scipen=20, digits=4, width=90)
z = Sys.setlocale("LC_TIME", "C")
if(!require(devtools)) install.packages("devtools")
if(!require(pacman)) install.packages("pacman")
if(!require(dplyr)) install.packages("dplyr")
if(!require(ggplot2)) install.packages("ggplot2")
if(!require(tidyr)) install.packages("tidyr")
if(!require(stringr)) install.packages("stringr")
pacman::p_load(dplyr,ggplot2,tidyr,stringr)
install.packages("devtools")
#
tapply(L$IBM$StockPrice,format(L$IBM$Date,'%m'), mean)
#
tapply(L$IBM$StockPrice,format(L$IBM$Date,'%m'), mean)
# Installation, setup & formatting. Do not modify this code chunk.
rm(list=ls(all=T))
knitr::opts_chunk$set(comment = NA)
knitr::opts_knit$set(global.par = TRUE)
par(cex=0.8); options(scipen=20, digits=4, width=90)
if(!require(pacman)) install.packages("pacman")
if(!require(dplyr)) install.packages("dplyr")
pacman::p_load(dplyr)
L = list(
IBM = read.csv("data/IBMStock.csv"),
GE = read.csv("data/GEStock.csv"),
PnG = read.csv("data/ProcterGambleStock.csv"),
Coke = read.csv("data/CocaColaStock.csv"),
Boeing = read.csv("data/BoeingStock.csv"))
lapply(L, class)
sapply(L, class)
sapply(L, names)
L = lapply(L, function(df) {
df$Date =  as.Date(df$Date, format="%m/%d/%y")
df
} )
#
sapply(L, count)
#
f<-function(df){
min(df$Date)
}
lapply(L,f)
#
f<-function(df){
max(df$Date)
}
lapply(L,f)
#
mean(L$IBM$StockPrice)
#
min(L$GE$StockPrice)
#
max(L$Coke$StockPrice)
#
median(L$Boeing$StockPrice)
#
sd(L$PnG$StockPrice)
#
plot(L$Coke$Date,L$Coke$StockPrice,type ='l')
#
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange')
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("2000-03-01","1983-01-01","1984-01-01")),col='gray',lty=3)
# going up: Coca-Cola
#
f<-function(df){
mean(df$StockPrice)
}
lapply(L,f)
# lower values: Boeing
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange',xlim=as.Date(c('1995-01-01','2005-12-01')),ylim=c(0,250))
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("2000-03-01","2000-05-01")),col='gray',lty=3)
# GE
# IBM
#
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange',xlim=as.Date(c('1996-01-01','1999-01-01')),ylim=c(0,250))
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("1997-09-01","1997-11-01")),col='gray',lty=3)
# PnG & Boeing
#
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange')
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("2004-01-01","2005-12-31")),col='gray',lty=3)
# Boeing
#
tapply(L$IBM$StockPrice,format(L$IBM$Date,'%m'), mean)
#
sort(tapply(L$GE$StockPrice,format(L$GE$Date,'%m'), mean),decreasing = T)
sort(tapply(L$Coke$StockPrice,format(L$Coke$Date,'%m'), mean),decreasing = T)
#April
#
mon_ave = sapply(L, function(df) {
tapply(df$StockPrice, format(df$Date,'%m'), mean)})
mon_ave
# December
mx = sapply(L, function(df) {
tapply(df$StockPrice, format(df$Date, "%m"), mean) })
mx
apply(mx, 2, which.max)
mx[c(1,12),]
mean(L$IBM$StockPrice)
#
mean(L$IBM$StockPrice)
tapply(L$IBM$StockPrice,format(L$IBM$Date,'%m'), mean)%>%
tapply(L$IBM$StockPrice,format(L$IBM$Date,'%m'), mean)
tapply(L$IBM$StockPrice,format(L$IBM$Date,'%m'), mean)%>% filter(.>=144.4)
tapply(L$IBM$StockPrice,format(L$IBM$Date,'%m'), mean)%>% filter(>=144.4)
tapply(L$IBM$StockPrice,format(L$IBM$Date,'%m'), mean)%>% filter(.>=144.4)
IBM_Mavg=tapply(L$IBM$StockPrice,format(L$IBM$Date,'%m'), mean)
filter(IBM_Mavg>=144.4)
IBM_Mavg=tapply(L$IBM$StockPrice,format(L$IBM$Date,'%m'), mean)
subset(IBM_Mavg>=144.4)
IBM_Mavg=tapply(L$IBM$StockPrice,format(L$IBM$Date,'%m'), mean)
subset(IBM_Mavg,IBM_Mavg>=144.4)
IBM_Mavg=tapply(L$IBM$StockPrice,format(L$IBM$Date,'%m'), mean)
subset(IBM_Mavg,IBM_Mavg>=mean(L$IBM$StockPrice))
#1,2,3,4,5 (months)
IBM_Mavg=tapply(L$IBM$StockPrice,format(L$IBM$Date,'%m'), mean)
IBM_Mavg=tapply(L$IBM$StockPrice,format(L$IBM$Date,'%m'), mean)
IBM_Mavg=tapply(L$IBM$StockPrice,format(L$IBM$Date,'%m'), mean)
# Installation, setup & formatting. Do not modify this code chunk.
rm(list=ls(all=T))
knitr::opts_chunk$set(comment = NA)
knitr::opts_knit$set(global.par = TRUE)
par(cex=0.8); options(scipen=20, digits=4, width=90)
if(!require(pacman)) install.packages("pacman")
if(!require(dplyr)) install.packages("dplyr")
pacman::p_load(dplyr)
L = list(
IBM = read.csv("data/IBMStock.csv"),
GE = read.csv("data/GEStock.csv"),
PnG = read.csv("data/ProcterGambleStock.csv"),
Coke = read.csv("data/CocaColaStock.csv"),
Boeing = read.csv("data/BoeingStock.csv"))
lapply(L, class)
sapply(L, class)
sapply(L, names)
L = lapply(L, function(df) {
df$Date =  as.Date(df$Date, format="%m/%d/%y")
df
} )
#
sapply(L, count)
#
f<-function(df){
min(df$Date)
}
lapply(L,f)
#
f<-function(df){
max(df$Date)
}
lapply(L,f)
#
mean(L$IBM$StockPrice)
#
min(L$GE$StockPrice)
#
max(L$Coke$StockPrice)
#
median(L$Boeing$StockPrice)
#
sd(L$PnG$StockPrice)
#
plot(L$Coke$Date,L$Coke$StockPrice,type ='l')
#
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange')
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("2000-03-01","1983-01-01","1984-01-01")),col='gray',lty=3)
# going up: Coca-Cola
#
f<-function(df){
mean(df$StockPrice)
}
lapply(L,f)
# lower values: Boeing
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange',xlim=as.Date(c('1995-01-01','2005-12-01')),ylim=c(0,250))
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("2000-03-01","2000-05-01")),col='gray',lty=3)
# GE
# IBM
#
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange',xlim=as.Date(c('1996-01-01','1999-01-01')),ylim=c(0,250))
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("1997-09-01","1997-11-01")),col='gray',lty=3)
# PnG & Boeing
#
plot(L$IBM$Date,L$IBM$StockPrice,type='l',col='orange')
lines(L$GE$Date,L$GE$StockPrice,type='l',col ='yellow')
lines(L$PnG$Date,L$PnG$StockPrice,type='l',col ='red')
lines(L$Coke$Date,L$Coke$StockPrice,type='l',col ='black')
lines(L$Boeing$Date,L$Boeing$StockPrice,type='l',col ='blue')
abline(v=as.Date(c("2004-01-01","2005-12-31")),col='gray',lty=3)
# Boeing
IBM_Mavg=tapply(L$IBM$StockPrice,format(L$IBM$Date,'%m'), mean)
IBM_Mavg
subset(IBM_Mavg,IBM_Mavg>=mean(L$IBM$StockPrice))
#1,2,3,4,5 (months)
