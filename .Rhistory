age = min(age),            # 顧客 年齡級別
area = min(area),          # 顧客 居住區別
items = n(),               # 交易項目(總)數
pieces = sum(qty),         # 產品(總)件數
total = sum(price),        # 交易(總)金額
gross = sum(price - cost)  # 毛利
) %>% data.frame
nrow(X) # 119422
sapply(X[,6:9], quantile, prob=c(.999, .9995, .9999,1))
X = subset(X, items<=62 & pieces<95 & total<16000) # 119328
#移除離群值，只保留99.99%數據
#訂單筆數由119422減少為119328筆
summary(X)
d0 = max(X$date) + 1
A = X %>% mutate(
days = as.integer(difftime(d0, date, units="days"))
) %>% group_by(cust) %>% summarise(
r = min(days),      # recency最小天數差異
s = max(days),      # seniority最大天數差異
f = n(),            # frequency頻率
m = mean(total),    # monetary金額的平均值
rev = sum(total),   # total revenue contribution總收入貢獻
raw = sum(gross),   # total gross profit contribution總毛利貢獻
age = min(age),     # age group
area = min(area),   # area code
) %>% data.frame
nrow(A) # 32241
summary(A)
A0 = A; X0 = X; Z0 = Z
save(Z0, X0, A0, file="C:/Users/abcmm/R practice/CM512-6/data/ta_feng_all_months_merged.csv")
# 這些程式碼設定網頁的格式，並安裝、載入一些基本的套件，請大家不要去改動<br>
rm(list=ls(all=T))
knitr::opts_chunk$set(comment = NA)
knitr::opts_knit$set(global.par = TRUE)
par(cex=0.8)
options(scipen=20, digits=5, width=80)
if(!require(FactoMineR)) install.packages("FactoMineR")
if(!require(factoextra)) install.packages("factoextra")
if(!require(MASS)) install.packages("MASS")
if(!require(dendextend)) install.packages("dendextend")
if(!require(pacman)) install.packages("pacman")
pacman::p_load(dplyr, ggplot2, readr, FactoMineR, factoextra, dendextend)
W = read.csv('data/wholesales.csv')
W$Channel = factor( paste0("Ch",W$Channel) )
W$Region = factor( paste0("Reg",W$Region) )
W[3:8] = lapply(W[3:8], log, base=10)
summary(W)
hc = W[,3:4] %>% scale %>% dist %>% hclust
plot(hc)
k=6; rect.hclust(hc, k=k, border="red")
W$group = cutree(hc, k=8) %>% factor
ggplot(W, aes(x=Fresh, y=Milk, col=group)) +
geom_point(size=3, alpha=0.5)
hc = W[,3:7] %>% scale %>% dist %>% hclust
plot(hc)
k = 6; rect.hclust(hc, k, border="red")
W$group = cutree(hc, k) %>% factor
hc %>% as.dendrogram %>% color_branches(k) %>% color_labels(k,col='white') %>% plot
names(W)[3:8] = c('生鮮','奶製品','雜貨','冷凍','清潔用品','熟食')
W[,3:8] %>% PCA(graph=FALSE) %>% fviz_pca_biplot(
col.ind=W$group,  #
label="var", pointshape=19, mean.point=F,
addEllipses=T, ellipse.level=0.7,
ellipse.type = "convex", palette="ucscgb",
repel=T
)
# This Chunk is for format setting, Do NOT Change the codes!
rm(list=ls(all=T))
knitr::opts_chunk$set(comment = NA)
knitr::opts_knit$set(global.par = TRUE)
par(cex=0.8)
options(scipen=20, digits=5, width=80)
if(!require(pacman)) install.packages("pacman")
pacman::p_load(dplyr, FactoMineR, factoextra)
D = decathlon2
head(D)
pca = PCA(D[,1:10])
pca
get_eigenvalue(pca)
pca$var$coord
pca$var$cos2
fviz_pca_var(pca)
pca$ind$coord
pca$ind$cos2
fviz_pca_ind(pca)
fviz_pca_biplot(
pca, pointsize="cos2", repel=T, labelsize=3,
col.var="red", col.ind="#E7B800", alpha.ind=0.3)
set.seed(444)
kmg = kmeans(scale(D[,1:10]), 5)$cluster %>% factor
table(kmg)
fviz_pca_biplot(
pca, repel=T, col.var="black", labelsize=3,
col.ind=kmg, alpha.ind=0.6, pointshape=16,
addEllipses = T, ellipse.level = 0.65,
mean.point = FALSE) +
theme(legend.position = "none")
fviz_pca_biplot(
pca, axes=c(1,3),
repel=T, col.var="black", labelsize=3,
col.ind=kmg, alpha.ind=0.6, pointshape=16,
addEllipses = T, ellipse.level = 0.65,
mean.point = FALSE) +
theme(legend.position = "none")
View(D)
load("C:/GitHub/NSYSU_CM512/code/mid/tafen123/data/tf0.rdata")
View(Z0)
View(X0)
View(X0)
load("C:/GitHub/NSYSU_CM512/code/mid/tafen123/data/tf3.rdata")
View(Z0)
View(Z0)
View(Z)
View(Z)
View(A0)
pacman::p_load(vcd, magrittr, readr, caTools, ggplot2, dplyr, plotly)
load("data/tf0.rdata")
sapply(list(cust=A0,tid=X0,items=Z0), nrow)
pacman::p_load(vcd, magrittr, readr, caTools, ggplot2, dplyr, plotly)
load("data/tf0.rdata")
sapply(list(cust=A0,tid=X0,items=Z0), nrow)
par(mfrow=c(1,2),cex=0.7)
table(A0$age) %>% barplot(las=2,main="Age Groups")
table(A0$area) %>% barplot(las=2,main="Areas")
MOSA = function(formula, data) mosaic(formula, data, shade=T,
margins=c(0,1,0,0), labeling_args = list(rot_labels=c(90,0,0,0)),
gp_labels=gpar(fontsize=9), legend_args=list(fontsize=9),
gp_text=gpar(fontsize=7),labeling=labeling_residuals)
MOSA(~age+area, A0)
result <- A0 %>%
group_by(area, age) %>%
summarize(total_customers = n())
# 输出结果
print(result)
result <- A0 %>%
group_by(area, age) %>%
summarize(total_customers = n())
# 输出结果
print(result)
result <- A0 %>%
group_by(area, age) %>%
summarize(total_customers = n())%>%
arrange(desc(total_customers))
# 输出结果
print(result)
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(rev),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = sum(rev),            # 平均revenue
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(rev),            # 平均revenue
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(raw)  # 總和淨收益
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = mean(raw)  # 總和淨收益
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(rev),            # 平均購買次數
avg.Revenue = mean(raw)  # 平均淨收益
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(rev),            # 平均銷售額
avg.Revenue = mean(raw)  # 平均淨收益
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均銷售額") + xlab("平均收益")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(rev),            # 平均銷售額
avg.Revenue = sum(raw)  # 平均淨收益
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均銷售額") + xlab("平均收益")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(m),            # 平均購買金額
avg.Revenue = mean(raw)  # 平均提供淨收益
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買金額") + xlab("平均提供淨收益")
sum(f*m)/sum(f)
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
)
print(avg.Revenue)
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
)%>%print(avg.Revenue)
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
aa=sum(m)
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f),  # 平均客單價
aa=sum(m)
)%>%print(avg.Revenue)
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f),  # 平均客單價
aa=mean(m)
)%>%print(avg.Revenue)
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f),  # 平均客單價
aa=mean(rev)
)%>%print(avg.Revenue)
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(f),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f),  # 平均客單價
aa=mean(m)
)%>%print(avg.Revenue)
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(raw),            # 平均購買次數
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = sum(raw),            # 總產生毛利
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = sum(raw)/(sum(f*m)/sum(f)),            # 總產生毛利
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(raw),            # 總產生毛利
avg.Revenue = sum(f*m)/sum(f)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均購買次數") + xlab("平均客單價")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(raw),            # 平均毛利
avg.Revenue = mean(r)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均毛利") + xlab("平均客單價")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(raw),            # 平均毛利
avg.Revenue = mean(s)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均毛利") + xlab("平均客單價")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(raw),            # 平均毛利
avg.Revenue = mean(r)  # 平均客單價
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均毛利") + xlab("平均客單價")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(raw),            # 平均毛利
avg.Revenue = mean(r)  # 平均顧客資歷
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均毛利") + xlab("平均顧客資歷")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(raw),            # 平均毛利
avg.Revenue = mean(s)  # 平均顧客資歷
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均毛利") + xlab("平均顧客資歷")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(raw),            # 平均毛利
avg.Revenue = mean(s)  # 平均顧客資歷
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均毛利") + xlab("平均顧客資歷")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(raw),            # 平均毛利
avg.Revenue = mean(r)  # 平均最近購買
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均毛利") + xlab("平均最近購買")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(r),            # 平均最近購買
avg.Revenue = mean(s)  # 平均顧客資歷
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均毛利") + xlab("平均顧客資歷")
A0 %>% filter(age!="a99") %>%    # 濾掉沒有年齡資料的顧客('a99')
group_by(area) %>% summarise(
Group.Size = n(),              # 族群人數
avg.Freq = mean(r),            # 平均最近購買
avg.Revenue = mean(s)  # 平均顧客資歷
) %>%
ggplot(aes(y=avg.Freq, x=avg.Revenue)) +
geom_point(aes(col=area, size=Group.Size), alpha=0.5) +
geom_text(aes(label=area)) +
scale_size(range=c(5,25)) +
theme_bw() + theme(legend.position="none") +
ggtitle("地理區隔特徵 (泡泡大小:族群人數)") +
ylab("平均最近購買") + xlab("平均顧客資歷")
knitr::include_graphics("./data/marketing_1.jpg")
knitr::include_graphics("./data/marketing/1.jpg")
knitr::include_graphics("./data/marketing/2.jpg")
knitr::include_graphics("./data/marketing/3.jpg")
knitr::include_graphics("./data/marketing/4.jpg")
knitr::include_graphics("./data/marketing/5.jpg")
knitr::include_graphics("./data/marketing/6.jpg")
